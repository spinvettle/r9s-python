## 代码规则
- 标注为 “Code generated by Speakeasy … DO NOT EDIT.” 的文件不要手改；优先改生成配置或在允许修改的扩展文件里改。
- 修改保持最小化：不做无关重构、不批量改格式、不引入新依赖（除非任务明确要求）。

## 目录与入口
- Python 包：`src/r9s/`
- CLI：`src/r9s/cli_tools/cli.py`（命令 `r9s`），仓库入口脚本：`main.py`
- Chat 交互：`src/r9s/cli_tools/chat_cli.py`
- CLI 国际化：`src/r9s/cli_tools/i18n.py`

## 架构概览
- **SDK 核心（生成代码为主）**
  - 入口：`src/r9s/sdk.py`（`R9S` 聚合各子 SDK：`chat`/`responses`/`models` 等）
  - HTTP：`src/r9s/httpclient.py` + `src/r9s/basesdk.py`（请求封装、重试、超时、序列化/反序列化）
  - 数据模型：`src/r9s/models/`（Pydantic 模型与 TypedDict）
  - Hooks：`src/r9s/_hooks/`（请求前/成功后/错误后等生命周期钩子；注册点在 `registration.py`）
- **CLI（手写代码为主）**
  - 命令入口：`src/r9s/cli_tools/cli.py`（`chat/set/reset`）
  - Chat：`src/r9s/cli_tools/chat_cli.py`（stdin/交互、多轮、history 持久化）
  - 扩展机制：`src/r9s/cli_tools/chat_extensions.py`（`--ext`/`R9S_CHAT_EXTENSIONS`，对输入/请求/流式增量/输出/命令的扩展点）
  - i18n：`src/r9s/cli_tools/i18n.py`（`--lang`/`R9S_LANG`）
- **典型调用链**
  - CLI `chat` → 组装 messages/history → `R9S(...).chat.create(...)` → HTTP 请求 → 解析模型响应/流式事件 → 输出到终端
